# 実装前チェックリスト

以下のすべてに「はい」と言えない場合、勝手に実装・修正を進めてはならない。

## 1. 変更の性質
- [ ] これは「バグ修正」「仕様に沿った追加」「明確に決まった仕様変更」のいずれかである
- [ ] 見た目のきれいさや個人の好みだけを目的にしたリファクタではない

## 2. 影響範囲
- [ ] どのドメインに影響するか明確（app / admin / ops / api）
- [ ] どの権限ユーザに影響するか明確（一般 / admin / ops）
- [ ] DBスキーマやRLSに影響しない、または影響する場合は別途ADRで記録する予定

## 3. Server Action
- [ ] Server Actionの追加/変更がある場合、`redirect()` を使っていない
- [ ] Server Actionは「結果オブジェクトを返し、遷移はクライアントで行う」方針と一致している
- [ ] 戻り値の型（例: `success`, `error`, `nextUrl`）を定義している

## 4. middleware・認証・ドメイン
- [ ] `middleware.ts` を変更しようとしていない
- [ ] もし `middleware.ts` を触るなら、理由・影響範囲・代替案を用意済み
- [ ] マルチドメイン (`*.local.test`) 前提を壊さない

## 5. 環境変数
- [ ] 新しい環境変数を追加していない
- [ ] もし追加が必要な場合、`docs/decisions/` にADRを書く予定である

## 6. テスト
- [ ] E2Eテストを追加/変更する場合、固定seedユーザ・固定組織を使う設計になっている
- [ ] その変更で `role` / `aria-*` に依存しているE2Eセレクタを壊さない
- [ ] Firefox / WebKit での待機（`waitForLoadState('domcontentloaded')`）が必要か確認済み